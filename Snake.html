<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title></title>
    <style>
        #display {
            font-weight: bold;
            background-color: green;
            color: black;
            text-align: center;
            font-size: 50pt;
        }
    </style>
</head>




<body style="
margin-left: 0px;
margin-bottom: 0px;
margin-right: 0px;
margin-top: 0px;
">
    <canvas id="myCanvas" width="420" height="420" style="border:1px solid #000000;">
    </canvas>
    <div id="display"></div>
    <script>
        var canvas = document.getElementById("myCanvas");
        var time = 130;
        var ctx = canvas.getContext("2d");
        let dx = 0;
        let dy = 0;
        let snakepos = [{ x: canvas.width / 2 - 10, y: canvas.height / 2 - 10 },
        { x: canvas.width / 2 - 10, y: canvas.height / 2 - 30 },
        { x: canvas.width / 2 - 10, y: canvas.height / 2 - 50 },
        { x: canvas.width / 2 - 10, y: canvas.height / 2 - 70 },
        { x: canvas.width / 2 - 10, y: canvas.height / 2 - 90 },
        ];
        let snake = {
            size: 20,
            moveUp: function moveUp() {
                if (dy === -20) { return }
                dy = 20;
                dx = 0;
            },
            moveDown: function moveDown() {
                if (dy === 20) { return }
                dy = -20;
                dx = 0;
            },
            moveLeft: function moveLeft() {
                if (dx === -20) { return }
                dx = 20;
                dy = 0;
            },
            moveRight: function moveRight() {
                if (dx === 20) { return }
                dx = -20;
                dy = 0;
            },
        }

        function checklose() {
            if ((snakepos[0].x < 0 || snakepos[0].y < 0 || snakepos[0].x + snake.size > canvas.width || snakepos[0].y + snake.size > canvas.height)) {
                clearInterval(intervalID);
                display.innerHTML = "проиграл";

            }

        };

        function render() {
            checklose()
            executeMoves();
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            snakepos.unshift({ x: snakepos[0].x - dx, y: snakepos[0].y - dy })
            snakepos.pop();
            for (i = 0; i < 5; i++) {
                ctx.fillStyle = "green";
                ctx.fillRect(snakepos[i].x, snakepos[i].y, snake.size, snake.size);
                ctx.lineWidth = 5;
                ctx.strokeStyle = "black";
                ctx.strokeRect(snakepos[i].x, snakepos[i].y, snake.size, snake.size);

            }
        }
        function executeMoves() {
            Object.keys(controller).forEach(key => {
                controller[key].pressed && controller[key].func()
            })
        }
        const controller = {
            87: { pressed: false, func: snake.moveUp },
            83: { pressed: false, func: snake.moveDown },
            65: { pressed: false, func: snake.moveLeft },
            68: { pressed: false, func: snake.moveRight },
        }

        document.addEventListener("keydown", (e) => {
            if (controller[e.keyCode]) {
                controller[e.keyCode].pressed = true
            }
        })
        document.addEventListener("keyup", (e) => {
            if (controller[e.keyCode]) {
                controller[e.keyCode].pressed = false
            }
        })
        var intervalID = setInterval(render, time)

    </script>
</body>

</html>
